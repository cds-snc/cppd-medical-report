{% extends "base.njk" %}

{% block content %}

    <h1>{{ __('medication.title') }}<br/> <span class="text-base">{{ __('patient_name')}} {{ patientName(data) }}</span></h1>

    <div>

        <form method="post">
            <input type="hidden" name="_csrf" value="{{ csrfToken }}">


            {{ textInput('medication_name', 'form.medication_name.desc', {required: true, "autocomplete": "off"}) }}
            {{ textInput('medication_dosage', 'form.medication_dosage.desc', {required: true, "autocomplete": "off"}) }}
            {{ textInput('medication_frequency', 'form.medication_frequency.desc', {required: true, hint: 'form.medication_frequency.hint', "autocomplete": "off"}) }}
            {{ textInput('medication_start_date', 'form.medication_start_date.text', { required: true, hint: 'form.medication_start_date.hint', "autocomplete": "off"})}}
            {{ textInput('medication_end_date', 'form.medication_end_date.text', {required: true, hint: 'form.medication_end_date.hint', "autocomplete": "off"})}}

            {% if oneValue %}
                {% set selectedValues = ["0"] %}
            {% else %}
                {% set selectedValues = data.medication_treated_condition %}
            {% endif %}
            {{ rawCheckBoxes('medication_treated_condition', 
                conditionList,
                selectedValues, 
                'form.medication_treated_conditions.question',{},
                {required: true}) 
            }}

            {{ textArea(
                'medication_results',
                'form.medicaiton_results.desc',
                { required: true, hint: 'form.medication_results.hint' }
            ) }}

            <div class="w-full flex">
                <div class="w-1/3">
                    <button type="submit">{{ __('add_medication.add_medication') }}</button>
                </div>
                {% if data.medications %}
                    <div class="w-1/3 text-center">
                        <a class="button-link transparent" href="{{ routePath('medication') }}">{{ __('Cancel') }}</a>
                    </div>
                {% else %}
                    <div class="w-1/3 text-center">
                        <a class="button-link transparent" href="{{ routePath('treatments') }}">{{ __('skip_section') }}</a>
                    </div>
                {% endif %}
            </div>
        </form>
    </div>

{% endblock %}
